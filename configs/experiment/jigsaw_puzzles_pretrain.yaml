# @package _global_

defaults:
  - baseline_augs
  - override /data/transforms@data.train_transforms: puzzle_augs
  - override /data/transforms@data.val_transforms: puzzle
  - _self_

tags: ["jigsaw_puzzles"]

seed: 12345

num_classes: 362880

data:
  train_dataset:
    _target_: src.data.components.animal_dataset.AnimalUnlabeledJigsawPuzzlesDataset
    _partial_: True
    root: train/unlabeled
  test_dataset:
  batch_size: 256
  num_classes: ${num_classes}

model:
  num_classes: ${num_classes}
  net:
    _target_: src.models.components.context_prediction_net.ContextPredictionNet
    num_classes: ${num_classes}
    encoder:
      _target_: torchvision.models.resnet18
    ignored_layers:
      - fc
    fc:
      - _target_: torch.nn.LazyLinear
        out_features: 4096
      - _target_: torch.nn.ReLU
      - _target_: torch.nn.Linear
        in_features: 4096
        out_features: 100
      - _target_: torch.nn.ReLU
      - _target_: torch.nn.Linear
        in_features: 100
        out_features: ${num_classes}

predict: False

logger:
  wandb:
    tags: ${tags}
